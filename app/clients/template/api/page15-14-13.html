{include file='public:header-css'/}
<div class="documents-dropzone">
	<div class="master-detail-layout">
		<div class="master-detail-layout__body">
			<main class="master-detail-layout__main-container">
				<div class="master-detail-layout__main-content">
					<div class="f-theme position-relative" style="width: 100%; height: 100%; background: rgb(83, 86, 89);">
						<div style="position: fixed; inset: 0px; z-index: 2000; background: rgba(0, 0, 0, 0);">
							<div class="master-detail-layout f-theme bg-white">
								{include file='public:header'/}
								<div class="master-detail-layout__body">
								    <main class="master-detail-layout__main-container">
                                    	<div class="master-detail-layout__main-content">
                                    		<div class="wizard-page-body w-max-700 w-full m-auto column justify-self align-stretch gap-20 pv-30 ph-30">
                                    			<h1 class="center text-center font-36 extrabold mt-20">Which of the following forms did you receive for your farm income?</h1>
                                    			<p class="text-center">
                                    				<span>Select all that apply</span>
                                    			</p>
                                    			<div style="height: 20px;"></div>
                                    			<div class="column justify-start align-stretch w-full gap-20">
                                    			    <?php
                                    			    $g=0;
                                    			    $nec=0;
                                    			    $misc=0;
                                    			    $k=0;
                                    			    $patr=0;
                                    			    $none=0;
                                    			    if($detail['farm_income_0_income_which_forms']!=''&&$detail['farm_income_0_income_which_forms']!='null'){
                                    			        $ary22=json_decode($detail['farm_income_0_income_which_forms'],true);
                                        			    foreach($ary22 as $key=>$val){
                                        			        switch($val){
                                        			          case '1099g':
                                        			          $g=1;
                                        			          break;
                                        			          case '1099nec':
                                        			          $nec=1;
                                        			          break;
                                        			          case '1099misc':
                                        			          $misc=1;
                                        			          break;
                                        			          case '1099k':
                                        			          $k=1;
                                        			          break;
                                        			          case '1099patr':
                                        			          $patr=1;
                                        			          break;
                                        			          case 'none':
                                        			          $none=1;
                                        			          break;
                                        			        }
                                        			    }
                                    			    }
                                    			    if($none){
                                                        $nextpage="page15-14-14";  
                                                    }else{
                                                        if($g){
                                                           $nextpage="page15-14-13-g";
                                                        }else{
                                                          if($nec){
                                                            $nextpage="page15-14-13-nec";
                                                            }else{
                                                                if($misc){
                                                                    $nextpage="page15-14-13-misc";
                                                                }else{
                                                                   if($k){
                                                                      $nextpage="page15-14-13-k"; 
                                                                   }else{
                                                                      if($patr){
                                                                        $nextpage="page15-14-13-patr"; 
                                                                      }else{
                                                                         $nextpage="page15-14-14";  
                                                                      }
                                                                   }
                                                                }
                                                            }
                                                        }
                                                    }
                                                    if($detail['farm_income_0_does_use_bookkeeping_software']==1){
                                                        $lastpage="page15-14-9";
                                                    }else{
                                                        $lastpage="page15-14-10";  
                                                    }
                                    			    ?>
                                    			    <div class="multi-select-option {if $g}multi-select-option--selected dark-theme{/if} row align-center" data-src="1099g">
                                    					<label class="option-label font-16">1099-G</label>
                                    					<span>&nbsp;</span>
                                    					<span class="font-14 font-weight-lighter text-align-right grow-1 color-white"></span>
                                    				</div>
                                    				<div class="multi-select-option {if $nec}multi-select-option--selected dark-theme{/if} row align-center" data-src="1099nec">
                                    					<label class="option-label font-16">1099-NEC</label>
                                    					<span>&nbsp;</span>
                                    					<span class="font-14 font-weight-lighter text-align-right grow-1 color-white"></span>
                                    				</div>
                                    				<div class="multi-select-option {if $misc}multi-select-option--selected dark-theme{/if} row align-center" data-src="1099misc">
                                    					<label class="option-label font-16">1099-MISC</label>
                                    					<span>&nbsp;</span>
                                    					<span class="font-14 font-weight-lighter text-align-right grow-1 color-white"></span>
                                    				</div>
                                    				<div class="multi-select-option {if $k}multi-select-option--selected dark-theme{/if} row align-center" data-src="1099k">
                                    					<label class="option-label font-16">1099-K</label>
                                    					<span>&nbsp;</span>
                                    					<span class="font-14 font-weight-lighter text-align-right grow-1 color-white"></span>
                                    				</div>
                                    				<div class="multi-select-option {if $patr}multi-select-option--selected dark-theme{/if} row align-center" data-src="1099patr">
                                    					<label class="option-label font-16">1099-PATR</label>
                                    					<span>&nbsp;</span>
                                    					<span class="font-14 font-weight-lighter text-align-right grow-1 color-white"></span>
                                    				</div>
                                    				<div class="multi-select-option row align-center {if $none}multi-select-option--selected dark-theme{/if}" data-src="none">
                                    					<label class="option-label font-16">None of the above</label>
                                    					<span class="font-14 font-weight-lighter text-align-right grow-1 color-grey"></span>
                                    				</div>
                                    			</div>
                                    		</div>
                                    	</div>
                                    </main>
								</div>
								<!--需要选择的单独写footer-->
								<form actoin="{$actionpage}" id="lastform" method="post">
									 <input type="hidden" name="page" value="{$lastpage}">
									 <input type="hidden" name="link" value="{$detail.link}">
								</form>
								<form actoin="{$actionpage}" id="nextform" method="post">
									 <input type="hidden" id="page" name="page" value="{$nextpage}">
									 <input type="hidden" name="link" value="{$detail.link}">
								</form>
							    {include file='public:footer2'/}
							<!--	<script>
								     $('.action-button').click(function () {
                                       var url=$(this).attr('data-src');
                                       if(url=='nextform'||url=="lastform"){
                                           var tag=0;
                                           if(url=='nextform'){
                                               $('.multi-select-option').each(function () {
                                                   if($(this).hasClass("multi-select-option--selected dark-theme")){
                                                       tag=1;
                                                   }
                                               });
                                               if(tag==0){
                                                   $('.banner--error').show();
                                                   return false;
                                               }
                                           }
                                           $('#'+url).submit();
                                       }else{
                                           if(url!='')location.href=url;else return false;
                                       }
                                    });
								</script>-->
							</div>
						</div>
					</div>
				</div>
			</main>
		</div>
	</div>
</div>
</iframe>
<script>
$(document).ready(function() {
      $('.multi-select-option').click(function () {
          var tt=$(this).attr('data-src');
          var fieldvalue=tt;
           if($(this).hasClass('multi-select-option--selected dark-theme')){
                $(this).removeClass('multi-select-option--selected dark-theme');
                $(this).find('span').removeClass('color-white');
                $(this).find('span').addClass('color-grey');
                var action="cancel";
            }else{
                $(this).addClass('multi-select-option--selected dark-theme');
                $(this).find('span').removeClass('color-grey');
                $(this).find('span').addClass('color-white');
                var action="select";
                if(tt=='none'){
                    //选中none其中都不选
                       $('.multi-select-option').each(function(){
                           if($(this).attr('data-src')!='none'){
                               $(this).removeClass('multi-select-option--selected dark-theme');
                                $(this).find('span').removeClass('color-white');
                                $(this).find('span').addClass('color-grey');
                           } 
                        });
                        
                  }else{
                      $('.multi-select-option').each(function(){
                           if($(this).attr('data-src')=='none'){
                               $(this).removeClass('multi-select-option--selected dark-theme');
                                $(this).find('span').removeClass('color-white');
                                $(this).find('span').addClass('color-grey');
                           } 
                        });
                  }
            }
           if(fieldvalue!=''){
               var fieldname="farm_income_0_income_which_forms";
             // alert($('#page').val());
             $('#savetime').html('Saving');
             ajax_post_field(fieldname,fieldvalue,action);  
           }
      });
     function ajax_post_field(fieldname,fieldvalue,action) {
         var pagename="{$pagename}";
         var link="{$detail.link}";
         $.ajax({
           url:"{:url('api/pagesave_form')}",
           type:'post',
           data:{'fieldname':fieldname,'fieldvalue':fieldvalue,'link':link,'pagename':pagename,'action':action},
           dataType:'json',
           success:function (res) {
               if (res.code==1){
                   $('#page').val(res.pagenext);
                   console.log('sucess');
                   var html='<div class="save-indicator font-14 bold row align-center justify-between gap-6 radius-4 pv-12 ph-12 save-indicator--" style="color: var(--color-darkgrey);"><svg class="check-icon" xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24"><path fill="currentColor" d="M20.285 2l-11.285 11.567-5.286-5.011-3.714 3.716 9 8.728 15-15.285z"></path></svg>'+res.savetime+'</div>';
                  $('#savetime').html(html);
               }else {
                   console.log('sucess');
                 //  msg(res.msg);
               }
           },error:function () {
               msg('Try it again later')
           }
      });
   }
});
</script>