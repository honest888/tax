<!--头部css位置s-->
{include file='public:header-css'/}
<!--头部css位置e-->
<link rel="stylesheet" href="__MOBILE__/css/form.css">
<body>
<!--头部导航位置s-->
<header class="header">
    <a class="back iconfont iconback"></a>
    <div class="title">支付密码</div>
    <a id="popup" class="iconfont iconmenu"></a>
</header>
<!--头部导航位置e-->
<!--内容区s-->
<form id="public-form" onsubmit="return false;" method="post">
    <div class="form-item">
        <div class="form-input">
            <div class="tit">手机号码</div>
            <input type="text" disabled value="{$user.mobile}">
        </div>
        {if empty($user.paypwd)}
        {if $edit_paypwd_sms_enable}
        <div class="form-input code">
            <div class="tit">验证码</div>
            <input type="text" maxlength="6" name="code" placeholder="请输入验证码">
            <button class="verify-code" type="button">获取验证码</button>
        </div>
        {/if}
        {else/}
        {if $edit_paypwd_sms_enable}
            <div class="form-input code">
                <div class="tit">验证码</div>
                <input type="text" maxlength="6" name="code" placeholder="请输入验证码">
                <button class="verify-code" type="button">获取验证码</button>
            </div>
            {else/}
            <div class="form-input">
                <div class="tit">原密码</div>
                <input type="password" name="oldpaypwd" placeholder="请输入原密码">
            </div>
        {/if}
        {/if}
        <div class="form-input">
            <div class="tit">新密码</div>
            <input type="password" id="password" name="password" placeholder="请输入新密码">
        </div>
        <div class="form-input">
            <div class="tit">确认密码</div>
            <input type="password" name="conpassword" placeholder="请输入确认密码">
        </div>
    </div>
    <div class="btn-list">
        {:token_field()}
        <input type="hidden" name="return"  value="{$return}">
        <button id="submit" class="bg-red" data-style="expand-left" type="button">提交</button>
        <input type="hidden" name="mobile" value="{$user.mobile}">
    </div>
</form>
<!--内容区e-->
</body>
<script>
    $(function () {
        $('.verify-code').click(function () {
            var mobile=$('[name=mobile]').val();
            send_code(this,mobile,'',"{$tpshop_config.sms_sms_time_out|default=60}")
        });
        public_validate('#public-form');
        $('#submit').click(function () {
            if (!$('#public-form').valid()){
                return false;
            }
            var url="{:url('User/paypwd')}";
            var data=$('#public-form').serialize();
            public_submit(url,data);
        });
    })
</script>
</html>